Module pyplots
  use kinds
  implicit none

contains

  ! 2-D line plot
  ! ------------------------------------------------------
  ! ------------------------------------------------------ 
  subroutine plot(x,y,title)
    use Kinds
    implicit none
    real(DP),dimension(:),intent(in) :: x,y
    character(len=*),intent(in)     :: title
    integer :: i,ID
    
    if (size(x) .ne. size(y)) then
       print *, "ERROR! sizes of arrays not equal"
       return
    end if

    ID = 1
    
    open(100,file="title.dat",action="write", &
         & status="replace",form="formatted")        
    open(101,file="ID.dat",action="write", &
         & status="replace",form="formatted")
    open(102,file="output.dat",action="write", &
         & status="replace",form="formatted")

    write(100,'(a)') title
    write(101,'(i10)') ID
    write(102,'(es12.5)') x(:)
    write(102,'(es12.5)') y(:)

    close(100)
    close(101)
    close(102)

    call system("./pyplots.py")

  end subroutine plot

  ! 2-D log plot
  ! ------------------------------------------------------
  ! ------------------------------------------------------ 
  subroutine loglog(x,y,title)
    real(dp),dimension(:),intent(in) :: x,y
    character(len=*),intent(in)     :: title
    integer :: i,ID

    if (size(x) .ne. size(y)) then
       print *, "ERROR! sizes of arrays not equal"
       return
    end if

    ID = 2

    open(100,file="title.dat",action="write", &
         & status="replace",form="formatted")        
    open(101,file="ID.dat",action="write", &
         & status="replace",form="formatted")
    open(102,file="output.dat",action="write", &
         & status="replace",form="formatted")

    write(100,'(a20)') title
    write(101,'(i10)') ID
    write(102,'(es12.5)') x(:)
    write(102,'(es12.5)') y(:)

    close(100)
    close(101)
    close(102)

    call system("./pyplots.py")
    
  end subroutine loglog

  ! 3-D line plot
  ! ------------------------------------------------------
  ! ------------------------------------------------------
  subroutine plot3(x,y,z,title)
    real(dp),dimension(:),intent(in) :: x,y,z    
    character(len=*),intent(in)     :: title
    integer :: i,ID

    if (size(x) .ne. size(y)) then
       print *, "ERROR! sizes of arrays not equal"
       return
    end if

    ID=3

    open(100,file="title.dat",action="write", &
         & status="replace",form="formatted")        
    open(101,file="ID.dat",action="write", &
         & status="replace",form="formatted")
    open(102,file="output.dat",action="write", &
         & status="replace",form="formatted")

    write(100,'(a20)') title
    write(101,'(i10)') ID
    write(102,'(es12.5)') x(:)
    write(102,'(es12.5)') y(:)
    write(102,'(es12.5)') z(:)

    close(100)
    close(101)
    close(102)

    call system("./pyplots.py")
    
  end subroutine plot3

  subroutine plotplot(x1,y1,x2,y2,title)
    real(dp),dimension(:),intent(in) :: x1,x2,y1,y2
    character(len=*),intent(in)     :: title
    integer :: i,ID

    if (size(x1) .ne. size(y1)) then
       print *, "ERROR! sizes of arrays not equal"
       return
    end if

    ID = 4

    open(100,file="title.dat",action="write", &
         & status="replace",form="formatted")        
    open(101,file="ID.dat",action="write", &
         & status="replace",form="formatted")
    open(102,file="output.dat",action="write", &
         & status="replace",form="formatted")

    write(100,'(a)') title
    write(101,'(i10)') ID
    write(102,'(es12.5)') x1(:)
    write(102,'(es12.5)') y1(:)
    write(102,'(es12.5)') x2(:)
    write(102,'(es12.5)') y2(:)

    close(100)
    close(101)
    close(102)

    call system("./pyplots.py")

  end subroutine plotplot


end Module pyplots
