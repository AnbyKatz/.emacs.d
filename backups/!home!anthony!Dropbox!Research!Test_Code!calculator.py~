#!/usr/bin/python3.5

import matplotlib.pyplot as pypl
import numpy as np
import math as m
from scipy.integrate import quad
from matplotlib import rc
from pylab import*
from sympy import*


MN = 939
RB = 0.6
Mq = 5
V = (4/3)*m.pi*(RB**3)

x1 = np.linspace(0.1,20,1000)
y1 = np.sin(x1)/x1
y2 = ( (np.sqrt(x1**2+(Mq**2)*(RB**2))-Mq*RB)/ (np.sqrt(x1**2+(Mq**2)*(RB**2))+Mq*RB) )*( (np.sin(x1)/(x1**2)) - np.cos(x1)/x1 )

idx = np.argwhere(np.diff(np.sign(y1 - y2)) != 0).reshape(-1) + 0
x = x1[idx[0]]

Omega0 = np.sqrt(x**2+(Mq**2)*(RB**2))
dOmega0 = Mq*RB*(x**2+(Mq**2)*(RB**2))**(-1/2)

B = ( MN -3*dOmega0  )/(V +4*m.pi*(RB**3) )
z = 3*Omega0-MN*RB+B*V*RB

